### .NET Cryptography Model
- .NET provides implementations of many standard cryptographic algorithms.
- Algorithm Type classes
	- `SymmetricAlgorithm`
	- `AsymmetricAlogorithm`
	- `HashAlgorithm`
- Algorithm classes (Inherits from Type classes)
	- AES
	- RSA
	- ECDiffieHellman
- Implementation classes (Inherits from Algorithm classes)
	- `AesManaged`
	- `RC2CryptoServiceProvider`
	- `ECDiffieHellmanCng`

### Cryptography Library
- Under the `System.Security.Cryptography` namespace, we have:
	- `SymmetricAlgorithm`
		- Encapsulate symmetric algorithms such as DES and Rijndeal(AES).
	- `AsymmetricAlgorithm`
		- Encapsulate the asymmetric algorithms such as RSA and DSA.
	- `HasAlgorithm`
		- Base call of all cryptographic hash algorithms.
	- `ToBase64Transform` and `FromBase64Transform`
		- Allows for conversion between byte stream and base64 representation.
	- `CryptographicException`
		- Error information for cryptographic operations.

### Symmetric Algorithms
- Encryption and decryption use the same secret key.
- Primary attack is "brute force" key search - (try every possible key)
- Key distribution and storage is difficult.
- Relatively fast.
- Advanced Encryption Standard (AES)
	- US government standard since 2001 (replaced DES)
	- Rijndeal algorithm (with 128 bit block size)
- Scenario example:
	- From plaintext (unencrypted data), data can be encrypted using a shared secret key. A cyphertext (Encrypted Data) is then sent to the receiving party, the receiving party uses the same shared secret key to decrypt the cyphertext into plaintext.
- Symmetric encryption requires the sender and the receiver to have the same key.
	- All symmetric algorithms are based upon this shared secret principle.
- Symmetric encryption involves a cryptographic key, requiring key management.
- For symmetric algorithms, the most important lesson is to store and send the key only by known secure means.

**Two Types**
- Symmetric algorithms can be divided into stream algorithms and block algorithms.
- Stream Algorithms (Stream Ciphers)
	- Operates directly on a stream of bytes and encrypt the bits of information one bit or 1 byte at a time. These algorithms are faster than block ciphers.
- Block Algorithms (Block Ciphers) encrypt information by breaking it down in fixed-length groups-blocks of bits (usually 64 bits) and encrypting one block at a time. Block algorithms are most commonly used in the IT world today.

### Symmetric Algorithms in .NET
- The following classes inherit the `SymmetricAlgorithm` class.
	- DES, TripleDES, Rijndael, RC2, AES
	- Namespace: `System.Security.Cryptography`
- They are abstract classes, so they cannot be instantiated directly.
	- Use public properties and methods of the `SymmetricAlgorithms` class.

**`SymmetricAlgorithms` class**
- Common public properties include:
	- `BlockSize`
	- `FeedbackSize`
	- `IV`
	- `Key`
	- `KeySize`
	- `LegalBlockSizes`
	- `LegalkeySizes`
	- `Mode`
	- `Padding`
- Common public methods:
	- `GenerateIV`
	- `GenerateKey`
	- `GetType`
	- `ValidKeySize`

### Encrypt/Decrypt using Symmetric Algorithm
**Encrypt**
- Generate Random Key.
- Generate Initialization Vector (IV).
- Use `CreateEncryptor()` to provide ciphertext.
- Store both the key and IV into DB.

**Decrypt**
- Retrieve Key and IV from DB.
- Use `CreateDecryptor()` to produce plaintext.

### Asymmetric Algorithms
- Also called "Public Key Cryptography"
- Utilizes 2 keys (public key and private key)
- Generally 100-1000 times slower than symmetric algorithms.
- Public key systems typically work using difficult math problems known as **trapdoor functions**.
- Popular asymmetric protocols:
	- RSA, Diffie-Hellman, ECC, and ElGamal

### Asymmetric Algorithm in .NET
- .NET provides RSA and DSA algorithms for asymmetric encryption/decryption.
- 2 classes are descendant of the `AsymmetricAlgorithm`, all of which are abstract classes:
	- RSA
	- DSA
- Both RSA and DSA classes have concrete implementations in `RSACryptoServiceProvider` and `DSACryptoServiceProvider` respectively.

### Encrypt/Decrypt using Asymmetric Algorithm
**Encrypt**
- Create instance of RSA CSP (new keys generated by default).
- Import keys (if required).
- Convert input string to `byte[]`.
- Encrypt.
- Resulting `byte[]` is cipher text.

**Decrypt**
- Decryption using `RSACryptoServiceProvider`
	- Assume `privateParams` and `encryptedText` is obtained from program.

### Asymmetric vs Symmetric
- Symmetric algorithm has problem of key distribution.
- Asymmetric is computationally expensive.
	- As asymmetric algorithms are inherently blocking ciphers (RSA), implementations can only encrypt block by block.
- More practical to combine both approach. (Electronic Key Exchange)
	- Encrypt using symmetric algorithm.
	- Distribute symmetric key securely using asymmetric algorithm.

### Hashing
- A hash is a special mathematical function that performs one-way encryption.
- Once the algorithm is processed, there is no way to:
	- Take the ciphertext and retrieve the plaintext that was used to generate it.
	- Generate two different plaintexts that compute to the same hash value.
- Common uses of hashing functions:
	- Storing user's passwords
	- Ensuring message integrity
		- To verify if message or file remains original and not edited.

**Hashing Functions**
- Converts a variable length input to a fixed length.
	- Creates a "digest" or "data fingerprint"
- "One-way"
	- Easy to compute, but cannot reverse.

### Common Hash Algorithms
- `HashAlgorithm` (abstract base class)
	- SHA (Secure Hash Algorithms)
		- SHA1
		- SHA265, SHA384, SHA512
	- MD5 (128 bit hash)
		- Has been compromised

### Hashing Algorithm in .NET
- Convert string to `byte[]`
- Create hash algorithm object 
- Call `ComputeHash`

### Hashed Passwords
- Best practice for passwords (cannot be retrieved)
- Used for authentication.
	- Common attack against hashed password is "dictionary attacks" 


### Salted/Unsalted hashes
^cefd82
**Salted Hash**
- Made up of random bits added to each password instance before its hashing.
- Creating a unique passwords even in the instance of two users choosing the same password.
- Helps mitigate hash table attacks.

**Unsalted Hash**
- Hashing using special mathematical function that performs one-way encryption without adding additional random bits to the password before its hashing.